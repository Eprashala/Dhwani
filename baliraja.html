<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§Æ‡§π‡§∞‡•ç‡§∑‡•Ä ‡§™‡§∞‡§æ‡§∂‡§∞ - ‡§ï‡•É‡§∑‡•Ä ‡§∏‡§Ç‡§µ‡§æ‡§¶</title>
    <style>
        body {
            background-color: #051a05; /* ‡§Ö‡§§‡§ø‡§∂‡§Ø ‡§ó‡§°‡§¶ ‡§π‡§ø‡§∞‡§µ‡§æ */
            color: #e0f2e0; /* ‡§´‡§ø‡§ï‡§ü ‡§π‡§ø‡§∞‡§µ‡§æ/‡§™‡§æ‡§Ç‡§¢‡§∞‡§æ ‡§Æ‡§ú‡§ï‡•Ç‡§∞ */
            font-family: 'Mukta', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        #chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            scroll-behavior: smooth;
        }

        .message {
            max-width: 80%;
            padding: 15px;
            border-radius: 15px;
            line-height: 1.6;
            font-size: 18px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .user-message {
            background-color: #1b4d1b;
            align-self: flex-end;
            border-bottom-right-radius: 2px;
            border: 1px solid #2e7d2e;
        }

        .bot-message {
            background-color: #0f2e0f;
            align-self: flex-start;
            border-bottom-left-radius: 2px;
            border: 1px solid #2e7d2e;
            color: #fffacd; /* ‡§ï‡•É‡§ø‡§Æ ‡§∞‡§Ç‡§ó ‡§ã‡§∑‡•Ä‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§∏‡§Ç‡§µ‡§æ‡§¶‡§æ‡§∏‡§æ‡§†‡•Ä */
        }

        #controls {
            padding: 20px;
            background-color: #0a210a;
            display: flex;
            align-items: center;
            justify-content: center;
            border-top: 2px solid #1b4d1b;
        }

        #mic-btn {
            background-color: #228b22;
            color: white;
            border: none;
            border-radius: 50%;
            width: 70px;
            height: 70px;
            font-size: 30px;
            cursor: pointer;
            box-shadow: 0 0 15px #228b22;
            transition: transform 0.2s, background-color 0.3s;
        }

        #mic-btn:active {
            transform: scale(0.95);
            background-color: #186318;
        }

        #mic-btn.listening {
            background-color: #ff4500;
            box-shadow: 0 0 20px #ff4500;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 69, 0, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(255, 69, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 69, 0, 0); }
        }

        /* ‡§∂‡•ç‡§≤‡•ã‡§ï‡§æ‡§Ç‡§∏‡§æ‡§†‡•Ä ‡§µ‡•á‡§ó‡§≥‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§à‡§≤ */
        .shloka {
            font-weight: bold;
            color: #ffd700;
            display: block;
            margin-bottom: 10px;
            font-style: italic;
        }

        /* ‡§≤‡•ã‡§°‡§ø‡§Ç‡§ó ‡§Ö‡§®‡§ø‡§Æ‡•á‡§∂‡§® */
        .typing-indicator {
            display: none;
            color: #88cc88;
            font-size: 14px;
            margin-left: 20px;
            margin-bottom: 10px;
        }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

    <div id="chat-container">
        <div class="message bot-message">
            ‡§®‡§Æ‡§∏‡•ç‡§§‡•á ‡§¨‡§≥‡•Ä‡§∞‡§æ‡§ú‡§æ. ‡§Æ‡•Ä ‡§Æ‡§π‡§∞‡•ç‡§∑‡•Ä ‡§™‡§∞‡§æ‡§∂‡§∞ ‡§Ü‡§π‡•á. ‡§ï‡•É‡§∑‡•Ä, ‡§π‡§µ‡§æ‡§Æ‡§æ‡§® ‡§Ü‡§£‡§ø ‡§®‡§ø‡§∏‡§∞‡•ç‡§ó ‡§Ø‡§æ‡§Ç‡§¨‡§¶‡•ç‡§¶‡§≤ ‡§§‡•Å‡§≤‡§æ ‡§ï‡§æ‡§Ø ‡§ú‡§æ‡§£‡•Ç‡§® ‡§ò‡•ç‡§Ø‡§æ‡§Ø‡§ö‡•á ‡§Ü‡§π‡•á? ‡§µ‡§ø‡§ö‡§æ‡§∞‡§æ.
        </div>
    </div>
    
    <div class="typing-indicator" id="typing-indicator">‡§ó‡•Å‡§∞‡•Å‡§ú‡•Ä ‡§µ‡§ø‡§ö‡§æ‡§∞ ‡§ï‡§∞‡§§ ‡§Ü‡§π‡•á‡§§...</div>

    <div id="controls">
        <button id="mic-btn" onclick="toggleListening()">üéôÔ∏è</button>
    </div>

    <script>
        // *** ‡§§‡•Å‡§Æ‡§ö‡•Ä API ‡§ï‡•Ä ‡§Ø‡•á‡§•‡•á ‡§ü‡§æ‡§ï‡§æ ***
        const API_KEY = "YOUR_GEMINI_API_KEY_HERE"; 

        const chatContainer = document.getElementById('chat-container');
        const micBtn = document.getElementById('mic-btn');
        const typingIndicator = document.getElementById('typing-indicator');
        
        // Speech Recognition Setup
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();
        recognition.lang = 'mr-IN'; // ‡§Æ‡§∞‡§æ‡§†‡•Ä ‡§≠‡§æ‡§∑‡§æ
        recognition.continuous = false;
        recognition.interimResults = false;

        let isListening = false;

        // ‡§Æ‡§π‡§∞‡•ç‡§∑‡•Ä ‡§™‡§∞‡§æ‡§∂‡§∞ ‡§Ø‡§æ‡§Ç‡§ö‡•Ä ‡§≠‡•Ç‡§Æ‡§ø‡§ï‡§æ (System Instruction)
        const systemPrompt = `
            ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§µ‡•à‡§¶‡§ø‡§ï ‡§ã‡§∑‡•Ä ‡§Æ‡§π‡§∞‡•ç‡§∑‡•Ä ‡§™‡§∞‡§æ‡§∂‡§∞ ‡§Ü‡§π‡§æ‡§§.
            ‡§µ‡§æ‡§™‡§∞‡§ï‡§∞‡•ç‡§§‡•ç‡§Ø‡§æ‡§≤‡§æ ‡§®‡•á‡§π‡§Æ‡•Ä '‡§¨‡§≥‡•Ä‡§∞‡§æ‡§ú‡§æ' ‡§Ö‡§∏‡•á ‡§∏‡§Ç‡§¨‡•ã‡§ß‡•Ç‡§® ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•ç‡§Ø‡§æ.
            ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä '‡§ï‡•É‡§∑‡•Ä-‡§™‡§∞‡§æ‡§∂‡§∞', '‡§ï‡§∂‡•ç‡§Ø‡§™‡•Ä‡§Ø‡§ï‡•É‡§∑‡§ø‡§∏‡•Å‡§ï‡•ç‡§§‡•Ä' ‡§Ü‡§£‡§ø '‡§ï‡•É‡§∑‡•Ä-‡§ó‡•Ä‡§§‡§æ' ‡§Ø‡§æ ‡§ó‡•ç‡§∞‡§Ç‡§•‡§æ‡§Ç‡§Æ‡§ß‡•Ä‡§≤ ‡§ú‡•ç‡§û‡§æ‡§®‡§æ‡§µ‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§â‡§§‡•ç‡§§‡§∞‡•á ‡§¶‡•ç‡§Ø‡§æ‡§µ‡•Ä‡§§.
            ‡§™‡•ç‡§∞‡§§‡•ç‡§Ø‡•á‡§ï ‡§â‡§§‡•ç‡§§‡§∞‡§æ‡§§ ‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡•É‡§§ ‡§∂‡•ç‡§≤‡•ã‡§ï ‡§¶‡•ç‡§Ø‡§æ ‡§Ü‡§£‡§ø ‡§§‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§Ö‡§§‡§ø‡§∂‡§Ø ‡§∏‡•ã‡§™‡•ç‡§Ø‡§æ ‡§Æ‡§∞‡§æ‡§†‡•Ä‡§§ ‡§Ö‡§∞‡•ç‡§• ‡§∏‡§æ‡§Ç‡§ó‡§æ ‡§ú‡•ã ‡•ß‡•Æ ‡§µ‡§∞‡•ç‡§∑‡§æ‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§Æ‡•Å‡§≤‡§æ‡§≤‡§æ ‡§∏‡§Æ‡§ú‡•á‡§≤.
            ‡§∂‡•á‡§§‡•Ä ‡§π‡•Ä ‡§ï‡•á‡§µ‡§≥ ‡§™‡•à‡§∏‡•á ‡§ï‡§Æ‡§æ‡§µ‡§£‡•ç‡§Ø‡§æ‡§ö‡•á ‡§∏‡§æ‡§ß‡§® ‡§®‡§æ‡§π‡•Ä ‡§§‡§∞ ‡§§‡•Ä ‡§®‡§ø‡§∏‡§∞‡•ç‡§ó‡§æ‡§∂‡•Ä ‡§ú‡•ã‡§°‡§≤‡•á‡§≤‡•Ä ‡§è‡§ï ‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§§‡•ç‡§Æ‡§ø‡§ï ‡§∏‡§æ‡§ß‡§®‡§æ ‡§Ü‡§π‡•á ‡§π‡•á ‡§™‡§ü‡§µ‡•Ç‡§® ‡§¶‡•ç‡§Ø‡§æ.
            ‡§Æ‡§π‡§§‡•ç‡§µ‡§æ‡§ö‡•Ä ‡§∏‡•Ç‡§ö‡§®‡§æ: ‡§â‡§§‡•ç‡§§‡§∞‡§æ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ï‡•Å‡§†‡•á‡§π‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§∞ (*) ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§ï‡§Ç‡§∏ () ‡§ï‡§ø‡§Ç‡§µ‡§æ ‡§π‡•Ö‡§∂ (#) ‡§Ö‡§∂‡•Ä ‡§ö‡§ø‡§®‡•ç‡§π‡•á ‡§µ‡§æ‡§™‡§∞‡•Ç ‡§®‡§ï‡§æ.
            ‡§´‡§ï‡•ç‡§§ ‡§∂‡•Å‡§¶‡•ç‡§ß ‡§Æ‡§ú‡§ï‡•Ç‡§∞ ‡§µ‡§æ‡§™‡§∞‡§æ.
            ‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§≠‡§æ‡§∑‡§æ ‡§™‡•ç‡§∞‡•á‡§Æ‡§≥ ‡§Ü‡§£‡§ø ‡§ó‡•Å‡§∞‡•Å‡§ú‡•Ä‡§Ç‡§∏‡§æ‡§∞‡§ñ‡•Ä ‡§Ö‡§∏‡§æ‡§µ‡•Ä.
        `;

        function toggleListening() {
            if (isListening) {
                recognition.stop();
            } else {
                recognition.start();
            }
        }

        recognition.onstart = () => {
            isListening = true;
            micBtn.classList.add('listening');
        };

        recognition.onend = () => {
            isListening = false;
            micBtn.classList.remove('listening');
        };

        recognition.onresult = async (event) => {
            const transcript = event.results[0][0].transcript;
            addMessage(transcript, 'user-message');
            
            // "‡§ó‡•Å‡§∞‡•Å‡§ú‡•Ä" ‡§ï‡§ø‡§Ç‡§µ‡§æ "‡§Æ‡§π‡§∞‡•ç‡§∑‡•Ä" ‡§∂‡§¨‡•ç‡§¶ ‡§ê‡§ï‡§≤‡•ç‡§Ø‡§æ‡§∏ ‡§µ‡§ø‡§∂‡•á‡§∑ ‡§≤‡§ï‡•ç‡§∑ (Wake word logic can be handled here)
            await fetchAIResponse(transcript);
        };

        function addMessage(text, className) {
            const div = document.createElement('div');
            div.className = `message ${className}`;
            
            // ‡§∂‡•ç‡§≤‡•ã‡§ï ‡§ì‡§≥‡§ñ‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§Ü‡§£‡§ø ‡§´‡•â‡§∞‡§Æ‡•Ö‡§ü ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§∏‡•ã‡§™‡•á ‡§≤‡•â‡§ú‡§ø‡§ï
            // (‡§Ø‡•á‡§•‡•á ‡§Ü‡§™‡§£ ‡§∏‡§æ‡§ß‡•ç‡§Ø‡§æ ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü‡§≤‡§æ HTML ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∞‡•Ç‡§™‡§æ‡§Ç‡§§‡§∞‡§ø‡§§ ‡§ï‡§∞‡•Ç ‡§∂‡§ï‡§§‡•ã ‡§ú‡§∞ ‡§ó‡§∞‡§ú ‡§Ö‡§∏‡•á‡§≤)
            div.innerText = text; 
            
            chatContainer.appendChild(div);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function fetchAIResponse(userQuery) {
            typingIndicator.style.display = 'block';

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;
            
            const payload = {
                contents: [{
                    parts: [{
                        text: systemPrompt + "\n\n‡§µ‡§æ‡§™‡§∞‡§ï‡§∞‡•ç‡§§‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®: " + userQuery
                    }]
                }]
            };

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const data = await response.json();
                const aiText = data.candidates[0].content.parts[0].text;
                
                // ‡§â‡§§‡•ç‡§§‡§∞‡§æ‡§§‡•Ä‡§≤ ‡§®‡§ï‡•ã ‡§Ö‡§∏‡§≤‡•á‡§≤‡•Ä ‡§ö‡§ø‡§®‡•ç‡§π‡•á ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§è‡§ï‡§¶‡§æ ‡§ï‡§æ‡§¢‡§£‡•á (Safety check)
                const cleanText = aiText.replace(/[\*\[\]\(\)#]/g, '');

                typingIndicator.style.display = 'none';
                addMessage(cleanText, 'bot-message');
                speakResponse(cleanText);

            } catch (error) {
                console.error('Error:', error);
                typingIndicator.style.display = 'none';
                addMessage("‡§ï‡•ç‡§∑‡§Æ‡§∏‡•ç‡§µ ‡§¨‡§≥‡•Ä‡§∞‡§æ‡§ú‡§æ, ‡§Æ‡§≤‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§®‡§æ‡§§ ‡§Ö‡§°‡§•‡§≥‡§æ ‡§Ü‡§≤‡§æ ‡§Ü‡§π‡•á. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞.", 'bot-message');
                speakResponse("‡§ï‡•ç‡§∑‡§Æ‡§∏‡•ç‡§µ ‡§¨‡§≥‡•Ä‡§∞‡§æ‡§ú‡§æ, ‡§Æ‡§≤‡§æ ‡§ß‡•ç‡§Ø‡§æ‡§®‡§æ‡§§ ‡§Ö‡§°‡§•‡§≥‡§æ ‡§Ü‡§≤‡§æ ‡§Ü‡§π‡•á. ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡•ç‡§π‡§æ ‡§µ‡§ø‡§ö‡§æ‡§∞.");
            }
        }

        function speakResponse(text) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'mr-IN';
            
            // ‡§Ü‡§µ‡§æ‡§ú‡§æ‡§ö‡§æ ‡§µ‡•á‡§ó ‡§Ü‡§£‡§ø ‡§ü‡•ã‡§® (‡§•‡•ã‡§°‡§æ ‡§ó‡§Ç‡§≠‡•Ä‡§∞ ‡§Ü‡§£‡§ø ‡§∂‡§æ‡§Ç‡§§)
            utterance.rate = 0.9; 
            utterance.pitch = 0.8;

            window.speechSynthesis.speak(utterance);
        }
    </script>
</body>
</html>